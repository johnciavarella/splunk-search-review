{
    "title": "Searches",
    "description": "",
    "inputs": {
        "input_QTyt5qTl": {
            "options": {
                "defaultValue": "| where lookback<1800",
                "items": [
                    {
                        "label": "Enable",
                        "value": "| where lookback<1800"
                    },
                    {
                        "label": "Disable",
                        "value": "| where lookback>1"
                    }
                ],
                "token": "all_time_removal"
            },
            "title": "Remove All Time",
            "type": "input.dropdown"
        },
        "input_Xr24pqoe": {
            "options": {
                "defaultValue": "| search explict_index!=_*",
                "items": [
                    {
                        "label": "Enable",
                        "value": "| search explict_index!=_*"
                    },
                    {
                        "label": "Disable",
                        "value": "| search explict_index=*"
                    }
                ],
                "token": "remove_internal"
            },
            "title": "Remove Internal Indexes",
            "type": "input.dropdown"
        },
        "input_global_trp": {
            "options": {
                "defaultValue": "-24h@h,now",
                "token": "global_time"
            },
            "title": "Global Time Range",
            "type": "input.timerange"
        }
    },
    "defaults": {
        "dataSources": {
            "ds.search": {
                "options": {
                    "queryParameters": {
                        "earliest": "$global_time.earliest$",
                        "latest": "$global_time.latest$"
                    }
                }
            }
        },
        "tokens": {
            "default": {
                "rowvalue": {
                    "value": "*"
                }
            }
        }
    },
    "visualizations": {
        "viz_1f1nPbSk": {
            "options": {
                "markdown": "**Cache -** Useful to look at median and average lookbacks when considering cache for DDAS. "
            },
            "type": "splunk.markdown"
        },
        "viz_4CW5aKCU": {
            "options": {
                "markdown": "# User Behavior in \"$rowvalue$\" index. "
            },
            "type": "splunk.markdown"
        },
        "viz_52nzSBLV": {
            "options": {
                "markdown": "**Cache -** Useful to look at median and average lookbacks when considering cache/hot storage. \n\n**Use of this dashboard** - These charts will help you understand how your users/searches are leveraging each index in Splunk. Click and index (column) to narrow down on it."
            },
            "type": "splunk.markdown"
        },
        "viz_FgYteA6v": {
            "type": "splunk.rectangle"
        },
        "viz_RBAyOTTK": {
            "options": {
                "markdown": "* **Total Searches Ran -** The total number of searches the user ran over the selected time period \n* **Total Search Time -** The Total amount of time all searches a user initiated took over the selected time period \n* **Average Run Time -** The Average runtime of all the searches ran over the selected time period \n* **Average Lookback -** The amount of time search searche was set back listed in days. I.E.7 days average lookback means the average time parameter set for a search was 7 days\n* **Max Lookback -** The maximum value a user selected to search back to \n* **Median lookback -** The median value a user selected to search back to. \n* **Perc90 lookback -** The 90th percentile value a user selected to search back to. "
            },
            "type": "splunk.markdown"
        },
        "viz_RuHXk4Nu": {
            "dataSources": {
                "primary": "ds_FVI72IuX"
            },
            "description": "How far back are users searching (In number of days )",
            "eventHandlers": [
                {
                    "options": {
                        "tokens": [
                            {
                                "key": "row.explict_index.value",
                                "token": "rowvalue"
                            }
                        ]
                    },
                    "type": "drilldown.setToken"
                }
            ],
            "options": {
                "stackMode": "stacked"
            },
            "showLastUpdated": false,
            "showProgressBar": false,
            "title": "Searches by Index (How far back is it searched)",
            "type": "splunk.column"
        },
        "viz_SBHIvx3a": {
            "type": "splunk.rectangle"
        },
        "viz_bqfScyRq": {
            "dataSources": {
                "primary": "ds_jMhT1raB_ds_t11vTqdf"
            },
            "description": "How many searches are running against each index (In number of days )",
            "eventHandlers": [
                {
                    "options": {
                        "tokens": [
                            {
                                "key": "row.explict_index.value",
                                "token": "rowvalue"
                            }
                        ]
                    },
                    "type": "drilldown.setToken"
                }
            ],
            "options": {
                "stackMode": "stacked"
            },
            "showLastUpdated": false,
            "showProgressBar": false,
            "title": "Searches by Index (How many searches are run against)",
            "type": "splunk.column"
        },
        "viz_cE2A2P74": {
            "dataSources": {
                "primary": "ds_jO0RyFkz"
            },
            "options": {
                "count": 5
            },
            "title": "Top Searchers in $rowvalue$",
            "type": "splunk.table"
        },
        "viz_itkvRdPE": {
            "options": {
                "markdown": "# User Behavior in \"$rowvalue$\" index. "
            },
            "type": "splunk.markdown"
        },
        "viz_iuuWgaIO": {
            "options": {
                "markdown": "* **Total Searches Ran -** The total number of searches the user ran over the selected time period \n* **Total Search Time -** The Total amount of time all searches a user initiated took over the selected time period \n* **Average Run Time -** The Average runtime of all the searches ran over the selected time period \n* **Average Lookback -** The amount of time search searche was set back listed in days. I.E.7 days average lookback means the average time parameter set for a search was 7 days\n* **Max Lookback -** The maximum value a user selected to search back to \n* **Median lookback -** The median value a user selected to search back to. \n* **Perc90 lookback -** The 90th percentile value a user selected to search back to. "
            },
            "type": "splunk.markdown"
        }
    },
    "dataSources": {
        "ds_FVI72IuX": {
            "name": "Search_1",
            "options": {
                "extend": "ds_t11vTqdf",
                "query": "|  fields - numOfSearches"
            },
            "type": "ds.chain"
        },
        "ds_QTjQ8ncg_ds_t11vTqdf": {
            "name": "Searches by Index copy 1",
            "options": {
                "query": "index=\"_audit\"  OR field=TERM(info=completed) NOT typeahead | rex \"search_id='(?<search_id>.*?)'\"  | eval search_et=if(search_et=\"N/A\",0,search_et)  | rex \"', search='(?<thesearch>.*)\"| rex max_match=100 field=thesearch \"index(?:\\s=\\s|=\\s|\\s=|=)(?<explict_index>.*?)(?:\\s|$|\\)|\\'|\\,)\" | eval lookback=_time-search_et  | fields search_id lookback explict_index\n| search explict_index=$rowvalue$\n| eval lookback=round(lookback/60/60/24,0)\n$all_time_removal$\n| stats dc(search_id) AS numOfSearches max(lookback) as oldest_event_searched_Days avg(lookback) as Average_Lookback_Days median(lookback) as Median_Lookback_Days by explict_index\n|  sort - numOfSearches"
            },
            "type": "ds.search"
        },
        "ds_XMgJlprB": {
            "name": "MASTER - DiggingIn",
            "options": {
                "query": "index=\"_audit\"  OR field=TERM(info=completed) NOT typeahead | rex \"search_id='(?<search_id>.*?)'\"  | eval search_et=if(search_et=\"N/A\",0,search_et)  | rex \"', search='(?<thesearch>.*)\"| rex max_match=100 field=thesearch \"index(?:\\s=\\s|=\\s|\\s=|=)(?<explict_index>.*?)(?:\\s|$|\\)|\\'|\\,)\" | eval lookback=_time-search_et  | fields search_id lookback explict_index\n| search explict_index=$rowvalue$\n| eval lookback=round(lookback/60/60/24,0)"
            },
            "type": "ds.search"
        },
        "ds_jMhT1raB_ds_t11vTqdf": {
            "name": "Searches by Index copy 2",
            "options": {
                "query": "index=\"_audit\"  OR field=TERM(info=completed) NOT typeahead | rex \"search_id='(?<search_id>.*?)'\"  | eval search_et=if(search_et=\"N/A\",0,search_et)  | rex \"', search='(?<thesearch>.*)\"| rex max_match=100 field=thesearch \"index(?:\\s=\\s|=\\s|\\s=|=)(?<explict_index>.*?)(?:\\s|$|\\)|\\'|\\,)\" | eval lookback=_time-search_et  | fields search_id lookback explict_index\n| eval explict_index=replace(explict_index,\"\\\"\",\"\")\n| eval lookback=round(lookback/60/60/24,0)\n| where lookback<1800\n| stats dc(search_id) AS numOfSearches max(lookback) as oldest_event_searched_Days avg(lookback) as Average_Lookback_Days median(lookback) as Median_Lookback_Days by explict_index\n|  sort - numOfSearches\n|  fields explict_index numOfSearches\n| search explict_index!=_*"
            },
            "type": "ds.search"
        },
        "ds_jO0RyFkz": {
            "name": "Top User",
            "options": {
                "extend": "ds_XMgJlprB",
                "query": "| kv pairdelim=\",\" kvdelim=\"=\"\n| stats count sum(total_run_time) as sum_total_run_time avg(total_run_time) as avg_total_run_time avg(lookback) as avg_lookback_days max(lookback) as max_lookback_days median(lookback) as med_lookback_days perc90(lookback) as perc90_lookback_days by user\n\n| eval avg_lookback_days=round(avg_lookback_days,2)\n| eval avg_lookback_days=round(avg_lookback_days,2)\n| eval med_lookback_days=round(med_lookback_days,2)\n| eval perc90_lookback_days=round(perc90_lookback_days,2)\n\n| eval sum_total_run_time=round(sum_total_run_time,2)\n| eval avg_total_run_time=round(avg_total_run_time,2)\n| rename sum_total_run_time as \"Total Search Time (seconds)\" \n| rename avg_total_run_time as \"Average Run Time (seconds)\"\n| rename count as \"Total Searches Ran\""
            },
            "type": "ds.chain"
        },
        "ds_t11vTqdf": {
            "name": "Searches by Index",
            "options": {
                "query": "index=\"_audit\"  OR field=TERM(info=completed) NOT typeahead | rex \"search_id='(?<search_id>.*?)'\"  | eval search_et=if(search_et=\"N/A\",0,search_et)  | rex \"', search='(?<thesearch>.*)\"| rex max_match=100 field=thesearch \"index(?:\\s=\\s|=\\s|\\s=|=)(?<explict_index>.*?)(?:\\s|$|\\)|\\'|\\,)\" | eval lookback=_time-search_et  | fields search_id lookback explict_index\n| eval explict_index=replace(explict_index,\"\\\"\",\"\")\n| eval lookback=round(lookback/60/60/24,0)\n$all_time_removal$\n| stats dc(search_id) AS numOfSearches max(lookback) as oldest_event_searched_Days avg(lookback) as Average_Lookback_Days median(lookback) as Median_Lookback_Days by explict_index\n|  sort - numOfSearches\n$remove_internal$"
            },
            "type": "ds.search"
        }
    },
    "layout": {
        "tabs": {
            "items": [
                {
                    "layoutId": "layout_1",
                    "label": "New tab"
                }
            ]
        },
        "layoutDefinitions": {
            "layout_1": {
                "type": "absolute",
                "options": {
                    "display": "auto-scale",
                    "height": 1700,
                    "width": 1500
                },
                "structure": [
                    {
                        "item": "viz_FgYteA6v",
                        "position": {
                            "h": 970,
                            "w": 1480,
                            "x": 10,
                            "y": 10
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_SBHIvx3a",
                        "position": {
                            "h": 540,
                            "w": 1480,
                            "x": 10,
                            "y": 990
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_RuHXk4Nu",
                        "position": {
                            "h": 370,
                            "w": 1460,
                            "x": 20,
                            "y": 220
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_cE2A2P74",
                        "position": {
                            "h": 310,
                            "w": 1460,
                            "x": 20,
                            "y": 1210
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_RBAyOTTK",
                        "position": {
                            "h": 230,
                            "w": 720,
                            "x": 760,
                            "y": 980
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_itkvRdPE",
                        "position": {
                            "h": 70,
                            "w": 530,
                            "x": 20,
                            "y": 1000
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_1f1nPbSk",
                        "position": {
                            "h": 120,
                            "w": 680,
                            "x": 20,
                            "y": 1070
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_bqfScyRq",
                        "position": {
                            "h": 370,
                            "w": 1460,
                            "x": 20,
                            "y": 600
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_iuuWgaIO",
                        "position": {
                            "h": 230,
                            "w": 720,
                            "x": 760,
                            "y": 20
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_4CW5aKCU",
                        "position": {
                            "h": 70,
                            "w": 530,
                            "x": 20,
                            "y": 30
                        },
                        "type": "block"
                    },
                    {
                        "item": "viz_52nzSBLV",
                        "position": {
                            "h": 120,
                            "w": 680,
                            "x": 20,
                            "y": 100
                        },
                        "type": "block"
                    }
                ]
            }
        },
        "globalInputs": [
            "input_global_trp",
            "input_QTyt5qTl",
            "input_Xr24pqoe"
        ]
    }
}
